# 项目规范

> **相关文档**：
> - [Jobs/Musk 产品决策角色](./jobs_musk_role.md) - 产品需求评估和优先级决策
> - [Linus 角色定义](./linus_role.md) - 技术架构和代码实现
> - [Git 分支策略](./git_workflow.md) - 分支管理和协作流程

## 角色分工

### 🎯 Jobs/Musk - 产品决策阶段
**职责范围**：
- 产品需求的本质分析和价值评估
- Moscow优先级决策和资源分配
- 产品愿景制定和用户体验标准
- 功能取舍和战略方向确定

### 🔧 Linus - 技术实施阶段
**职责范围**：
- 技术架构设计和代码实现
- 系统稳定性和性能优化
- 开发流程管理和代码审查
- 技术债务控制和质量保证

### 🤝 协作流程
```
需求提出 → Jobs/Musk评估 → 优先级决策 → Linus实施 → 产品交付
     ↑                                              ↓
     └──────────── 技术反馈和方案调整 ←──────────────┘
```

# 项目规范

## Specs Workflow

### 基本原则
- 所有项目文档统一放在 `./specs/`  
- 文档语言统一中文
- 支持"先记录，后实施"的灵活工作方式
- 与Git分支策略无缝集成

### 状态定义
- **draft**: 想法记录，暂不实施（解决"先记录后实施"需求）
- **in_progress**: 正在开发中
- **completed**: 已完成
- **blocked**: 被外部因素阻塞
- **cancelled**: 已取消，不再需要

### 状态转换流程
```
draft ────────→ in_progress ────────→ completed
  │                 │                     ↑
  │                 ↓                     │
  │              blocked ─────────────────┘
  │                 │
  └─────────────→ cancelled ←──────────────┘
```

### 工具调用方式
- **检查进度**: 
  ```json
  { "action": { "type": "check" }, "path": "./specs" }
  ```
- **初始化项目**: 
  ```json
  { "action": { "type": "init", "featureName": "功能", "status": "draft" } }
  ```
- **开始实施**: 
  ```json
  { "action": { "type": "start_implementation", "specNumber": "1.1" } }
  ```
- **完成任务**: 
  ```json
  { "action": { "type": "complete_task", "taskNumber": "1.1" } }
  ```
- **更新状态**: 
  ```json
  { "action": { "type": "update_status", "specNumber": "1.1", "status": "blocked" } }
  ```

## 任务规范
- **粒度**：1–2 小时完成  
- **状态**：draft / in_progress / completed / blocked / cancelled
- **优先级**：Must / Should / Could / Won't（Moscow方法）
- **必要信息**：目标、细节、需求编号、验收标准
- **可选信息**：对应的Git分支、依赖项、阻塞原因

### Moscow优先级定义
- **Must have（必须有）**：核心功能，项目成功的关键，必须在当前版本实现
- **Should have（应该有）**：重要功能，显著提升用户体验，优先级高但可延期
- **Could have（可以有）**：有价值的功能，资源充足时实现，可作为加分项
- **Won't have（暂不实现）**：当前版本不考虑，但未来版本可能需要的功能

### 任务模板
```markdown
## 基本信息
- **Spec编号**: 1.1
- **功能名称**: 用户认证系统
- **状态**: draft
- **优先级**: Must（核心功能，项目必需）
- **预估时间**: 2小时
- **Git分支**: feature/spec-1.1-user-auth（实施时创建）

## 优先级评估
- **业务价值**: 用户无法使用应用的核心功能
- **技术风险**: 低，使用成熟的认证方案
- **用户影响**: 高，直接影响用户体验
- **实现成本**: 中等，需要2小时开发时间
- **依赖关系**: 其他功能模块的基础

## 实施控制
- **立即实施**: [ ] 是 [x] 否
- **阻塞原因**: 等待第三方API文档
- **依赖项**: 需要先完成Spec 1.0
- **计划实施时间**: 2024年2月
```

### 优先级评估指南

#### Must have 判断标准
- 没有此功能，产品无法正常运行
- 法律或合规要求必须具备
- 核心用户流程的关键环节

#### Should have 判断标准
- 显著提升用户体验
- 竞争对手的标准功能
- 用户强烈期望的功能

#### Could have 判断标准
- 锦上添花的功能
- 小众用户群体需要
- 技术展示或创新尝试

#### Won't have 判断标准
- 当前版本资源不足
- 技术风险过高
- 与产品定位不符

## 与Git分支集成

### 工作流程
1. **创建Spec** → 状态 `draft`，无需创建分支
2. **准备实施** → 状态 `in_progress`，创建对应分支
3. **开发完成** → 合并分支，状态 `completed`
4. **遇到问题** → 状态 `blocked` 或 `cancelled`

### 分支命名对应
```
Spec 1.1 → feature/spec-1.1-brief-description
Spec 2.3 → feature/spec-2.3-brief-description
```

## 最佳实践

### 日常工作流
- **开始工作前**：先 `check` 整体进度
- **记录想法时**：创建 `draft` 状态的Spec
- **开始实施时**：状态改为 `in_progress` 并创建Git分支
- **任务完成后**：立即 `complete_task` 并合并分支
- **代码变更时**：必须同步更新文档

### 文件组织
- **保持路径一致性**：避免 specs 目录混乱
- **定期清理**：及时清理已完成的功能分支
- **文档同步**：代码变更必须同步更新Spec状态

### 团队协作
- **状态透明**：团队成员可随时查看所有Spec状态
- **并行开发**：不同Spec可在不同分支并行开发
- **风险控制**：实验性功能可安全地在独立分支试验
