# Spec 1.4 - æ ·å¼è°ƒæ•´åŠŸèƒ½

## åŸºæœ¬ä¿¡æ¯
- **çŠ¶æ€**: draft
- **ä¼˜å…ˆçº§**: Should (ç”¨æˆ·ä½“éªŒ)
- **é¢„ä¼°æ—¶é—´**: 1.5å°æ—¶
- **è´Ÿè´£è§’è‰²**: @CTO_Linus
- **Gitåˆ†æ”¯**: feature/spec-1.4-style-adjusterï¼ˆå®æ–½æ—¶åˆ›å»ºï¼‰

## åŠŸèƒ½æè¿°
æä¾›ç”¨æˆ·å‹å¥½çš„æ ·å¼è°ƒæ•´ç•Œé¢ï¼Œå…è®¸ç”¨æˆ·å®æ—¶é¢„è§ˆå’Œè°ƒæ•´è·¯çº¿å›¾çš„è§†è§‰æ ·å¼ï¼ŒåŒ…æ‹¬é¢œè‰²ã€ç²—ç»†ã€å­—ä½“ç­‰é€‰é¡¹ã€‚

## è¯¦ç»†éœ€æ±‚

### æ ·å¼è°ƒæ•´é€‰é¡¹

#### è·¯çº¿æ ·å¼
- **é¢œè‰²æ–¹æ¡ˆ**: 5ç§é¢„è®¾é…è‰²ï¼Œç‚¹å‡»åˆ‡æ¢
  - ğŸ”µ ç»å…¸è“è‰²æ¸å˜
  - ğŸŸ  æ´»åŠ›æ©™è‰²æ¸å˜  
  - ğŸŸ¢ è‡ªç„¶ç»¿è‰²æ¸å˜
  - ğŸŸ£ ä¼˜é›…ç´«è‰²æ¸å˜
  - ğŸ”´ çƒ­æƒ…çº¢è‰²æ¸å˜
- **çº¿æ¡ç²—ç»†**: 3ä¸ªæ¡£ä½é€‰æ‹©
  - ç»†çº¿: 4px
  - ä¸­ç­‰: 6px (é»˜è®¤)
  - ç²—çº¿: 8px
- **çº¿æ¡æ ·å¼**: 2ç§ç±»å‹
  - å®çº¿ (é»˜è®¤)
  - è™šçº¿

#### æ–‡å­—æ ·å¼
- **å­—ä½“å¤§å°**: 3ä¸ªæ¡£ä½
  - å°å·: 14px
  - ä¸­å·: 16px (é»˜è®¤)
  - å¤§å·: 18px
- **å­—ä½“é¢œè‰²**: 2ç§é€‰æ‹©
  - è·Ÿéšè·¯çº¿è‰²å½©
  - å›ºå®šæ·±ç°è‰² #333333 (é»˜è®¤)

#### æ•´ä½“é£æ ¼
- **ğŸ¢ å•†åŠ¡é£æ ¼**: æ·±è‰²è°ƒï¼Œç®€æ´çº¿æ¡ï¼Œé€‚åˆå•†åŠ¡åœºæ™¯
- **ğŸŒ¸ ä¼‘é—²é£æ ¼**: æš–è‰²è°ƒï¼Œåœ†æ¶¦å…ƒç´ ï¼Œé€‚åˆä¼‘é—²æ—…æ¸¸
- **ğŸ“š æ–‡è‰ºé£æ ¼**: å¤å¤è‰²è°ƒï¼Œæ‰‹ç»˜æ„Ÿè§‰ï¼Œé€‚åˆæ–‡è‰ºé’å¹´

### äº¤äº’è®¾è®¡

#### æ§åˆ¶é¢æ¿å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¨ æ ·å¼è°ƒæ•´                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                             â”‚
â”‚  é¢œè‰²æ–¹æ¡ˆ                                    â”‚
â”‚  ğŸ”µ ğŸŸ  ğŸŸ¢ ğŸŸ£ ğŸ”´                            â”‚
â”‚                                             â”‚
â”‚  çº¿æ¡ç²—ç»†                                    â”‚
â”‚  â—‹ ç»†  â— ä¸­  â—‹ ç²—                          â”‚
â”‚                                             â”‚
â”‚  æ•´ä½“é£æ ¼                                    â”‚
â”‚  ğŸ’¼ å•†åŠ¡  ğŸŒ¸ ä¼‘é—²  ğŸ“š æ–‡è‰º                   â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  é‡ç½®é»˜è®¤    â”‚  â”‚  åº”ç”¨æ ·å¼    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å®æ—¶é¢„è§ˆ
- **å³æ—¶åé¦ˆ**: ç‚¹å‡»æ ·å¼é€‰é¡¹ç«‹å³åœ¨é¢„è§ˆåŒºåŸŸç”Ÿæ•ˆ
- **é¢„è§ˆè´¨é‡**: ä½¿ç”¨ä¸æœ€ç»ˆè¾“å‡ºç›¸åŒçš„æ¸²æŸ“è´¨é‡
- **åŠ è½½çŠ¶æ€**: æ ·å¼åˆ‡æ¢æ—¶æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨
- **é”™è¯¯å¤„ç†**: æ¸²æŸ“å¤±è´¥æ—¶æ˜¾ç¤ºå‹å¥½æç¤º

## æŠ€æœ¯å®ç°

### æ ¸å¿ƒæ¥å£è®¾è®¡
```typescript
interface StyleAdjuster {
  // åº”ç”¨æ ·å¼é…ç½®
  applyStyle(config: StyleConfig): Promise<void>
  
  // é‡ç½®ä¸ºé»˜è®¤æ ·å¼
  resetToDefault(): void
  
  // è·å–å½“å‰æ ·å¼é…ç½®
  getCurrentStyle(): StyleConfig
  
  // é¢„è®¾æ ·å¼æ–¹æ¡ˆ
  getPresetStyles(): PresetStyle[]
}

interface StyleConfig {
  // è·¯çº¿æ ·å¼
  colorScheme: ColorScheme
  lineWidth: LineWidth
  lineStyle: 'solid' | 'dashed'
  
  // æ–‡å­—æ ·å¼
  fontSize: FontSize
  fontColor: 'auto' | 'fixed'
  
  // æ•´ä½“é£æ ¼
  theme: 'business' | 'casual' | 'artistic'
  
  // é«˜çº§é€‰é¡¹
  showShadow: boolean
  shadowIntensity: number
}

type ColorScheme = 'blue' | 'orange' | 'green' | 'purple' | 'red'
type LineWidth = 'thin' | 'medium' | 'thick'
type FontSize = 'small' | 'medium' | 'large'

interface PresetStyle {
  name: string
  description: string
  config: StyleConfig
  preview: string // é¢„è§ˆå›¾URL
}
```

### æ ·å¼ç³»ç»Ÿæ¶æ„

#### 1. æ ·å¼é…ç½®ç®¡ç†
```typescript
class StyleManager {
  private currentConfig: StyleConfig
  private defaultConfig: StyleConfig
  private presets: Map<string, PresetStyle>
  
  constructor() {
    this.defaultConfig = this.getDefaultConfig()
    this.currentConfig = { ...this.defaultConfig }
    this.initializePresets()
  }
  
  updateConfig(updates: Partial<StyleConfig>): void {
    this.currentConfig = { ...this.currentConfig, ...updates }
    this.notifyChange()
  }
  
  private notifyChange(): void {
    // è§¦å‘é‡æ–°æ¸²æŸ“
    this.onConfigChange?.(this.currentConfig)
  }
}
```

#### 2. é¢„è®¾æ ·å¼å®šä¹‰
```typescript
const PRESET_STYLES: PresetStyle[] = [
  {
    name: 'å•†åŠ¡é£æ ¼',
    description: 'æ·±è‰²è°ƒï¼Œç®€æ´ä¸“ä¸š',
    config: {
      colorScheme: 'blue',
      lineWidth: 'medium',
      lineStyle: 'solid',
      fontSize: 'medium',
      fontColor: 'fixed',
      theme: 'business',
      showShadow: false,
      shadowIntensity: 0
    }
  },
  {
    name: 'ä¼‘é—²é£æ ¼', 
    description: 'æš–è‰²è°ƒï¼Œè½»æ¾æ„‰å¿«',
    config: {
      colorScheme: 'orange',
      lineWidth: 'thick',
      lineStyle: 'solid',
      fontSize: 'large',
      fontColor: 'auto',
      theme: 'casual',
      showShadow: true,
      shadowIntensity: 0.3
    }
  }
  // ... æ›´å¤šé¢„è®¾
]
```

#### 3. å®æ—¶é¢„è§ˆå®ç°
```typescript
class StylePreview {
  private canvas: HTMLCanvasElement
  private renderer: VisualRenderer
  private routeData: RouteData
  
  async updatePreview(config: StyleConfig): Promise<void> {
    try {
      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      this.showLoading()
      
      // åº”ç”¨æ–°æ ·å¼å¹¶é‡æ–°æ¸²æŸ“
      const styledCanvas = await this.renderer.renderRouteMap(this.routeData, config)
      
      // æ›´æ–°é¢„è§ˆæ˜¾ç¤º
      this.updateCanvas(styledCanvas)
      
      // éšè—åŠ è½½çŠ¶æ€
      this.hideLoading()
    } catch (error) {
      this.showError('æ ·å¼åº”ç”¨å¤±è´¥ï¼Œè¯·é‡è¯•')
    }
  }
}
```

## éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½å®Œæ•´æ€§éªŒæ”¶
- [ ] æ‰€æœ‰æ ·å¼é€‰é¡¹éƒ½èƒ½æ­£å¸¸å·¥ä½œ
- [ ] å®æ—¶é¢„è§ˆåŠŸèƒ½æ­£å¸¸ï¼Œæ— æ˜æ˜¾å»¶è¿Ÿ
- [ ] é‡ç½®åŠŸèƒ½èƒ½æ¢å¤åˆ°é»˜è®¤çŠ¶æ€
- [ ] é¢„è®¾æ ·å¼æ–¹æ¡ˆèƒ½æ­£ç¡®åº”ç”¨

### ç”¨æˆ·ä½“éªŒéªŒæ”¶
- [ ] ç•Œé¢å¸ƒå±€æ¸…æ™°ï¼Œæ“ä½œç›´è§‚
- [ ] æ ·å¼åˆ‡æ¢å“åº”æ—¶é—´ <500ms
- [ ] åŠ è½½çŠ¶æ€æœ‰æ˜ç¡®åé¦ˆ
- [ ] é”™è¯¯æƒ…å†µæœ‰å‹å¥½æç¤º

### è§†è§‰æ•ˆæœéªŒæ”¶
- [ ] ä¸åŒæ ·å¼æ–¹æ¡ˆè§†è§‰å·®å¼‚æ˜æ˜¾
- [ ] é¢„è®¾é£æ ¼ç¬¦åˆæè¿°å’Œé¢„æœŸ
- [ ] æ ·å¼ç»„åˆæ­é…å’Œè°ç¾è§‚
- [ ] åœ¨ä¸åŒè®¾å¤‡ä¸Šæ˜¾ç¤ºä¸€è‡´

## æµ‹è¯•ç”¨ä¾‹

### åŸºç¡€åŠŸèƒ½æµ‹è¯•
```
æ“ä½œ: ç‚¹å‡»è“è‰²æ–¹æ¡ˆ
æœŸæœ›: è·¯çº¿å›¾ç«‹å³å˜ä¸ºè“è‰²æ¸å˜

æ“ä½œ: è°ƒæ•´çº¿æ¡ç²—ç»†ä¸º"ç²—"
æœŸæœ›: è·¯çº¿å˜ç²—ï¼Œå…¶ä»–å…ƒç´ ä¸å˜

æ“ä½œ: åˆ‡æ¢åˆ°å•†åŠ¡é£æ ¼
æœŸæœ›: æ•´ä½“æ ·å¼å˜ä¸ºå•†åŠ¡é£æ ¼é…ç½®
```

### ç»„åˆåŠŸèƒ½æµ‹è¯•
```
æ“ä½œ: å…ˆé€‰æ‹©æ©™è‰²æ–¹æ¡ˆï¼Œå†é€‰æ‹©æ–‡è‰ºé£æ ¼
æœŸæœ›: ä¸¤ä¸ªè®¾ç½®éƒ½ç”Ÿæ•ˆï¼Œæ ·å¼æ­£ç¡®ç»„åˆ

æ“ä½œ: å¤šæ¬¡å¿«é€Ÿåˆ‡æ¢é¢œè‰²æ–¹æ¡ˆ
æœŸæœ›: æ¯æ¬¡åˆ‡æ¢éƒ½èƒ½æ­£ç¡®å“åº”ï¼Œæ— å¡é¡¿

æ“ä½œ: åº”ç”¨æ ·å¼åç‚¹å‡»é‡ç½®
æœŸæœ›: æ¢å¤åˆ°åˆå§‹é»˜è®¤çŠ¶æ€
```

### å¼‚å¸¸æƒ…å†µæµ‹è¯•
```
åœºæ™¯: ç½‘ç»œè¾ƒæ…¢æ—¶åˆ‡æ¢æ ·å¼
æœŸæœ›: æ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼Œå®Œæˆåæ­£ç¡®æ›´æ–°

åœºæ™¯: æ¸²æŸ“è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯
æœŸæœ›: æ˜¾ç¤ºé”™è¯¯æç¤ºï¼Œä¸å½±å“å…¶ä»–åŠŸèƒ½

åœºæ™¯: è¿ç»­å¿«é€Ÿç‚¹å‡»æ ·å¼é€‰é¡¹
æœŸæœ›: é˜²æŠ–å¤„ç†ï¼Œæœ€ç»ˆçŠ¶æ€æ­£ç¡®
```

## ä¾èµ–å…³ç³»

- **å‰ç½®æ¡ä»¶**: spec-1.3 è§†è§‰æ¸²æŸ“åŠŸèƒ½å®Œæˆ
- **é˜»å¡å› ç´ **: æ— 
- **åç»­ä»»åŠ¡**: spec-1.6 ç”¨æˆ·ç•Œé¢åŠŸèƒ½

## é£é™©è¯„ä¼°

- **æŠ€æœ¯é£é™©**: ä½ï¼Œä¸»è¦æ˜¯UIäº¤äº’é€»è¾‘
- **æ—¶é—´é£é™©**: ä½ï¼ŒåŠŸèƒ½ç›¸å¯¹ç®€å•
- **èµ„æºé£é™©**: ä½ï¼Œä¸æ¶‰åŠå¤§é‡è®¡ç®—

## æ€§èƒ½ä¼˜åŒ–

### å“åº”æ€§ä¼˜åŒ–
- **é˜²æŠ–å¤„ç†**: é¿å…é¢‘ç¹çš„æ ·å¼åˆ‡æ¢å¯¼è‡´æ€§èƒ½é—®é¢˜
- **ç¼“å­˜æœºåˆ¶**: ç¼“å­˜å·²æ¸²æŸ“çš„æ ·å¼ç»“æœ
- **å¼‚æ­¥æ¸²æŸ“**: ä½¿ç”¨Web Workerè¿›è¡Œåå°æ¸²æŸ“

### ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- **é¢„åŠ è½½**: é¢„åŠ è½½å¸¸ç”¨æ ·å¼çš„é¢„è§ˆå›¾
- **æ¸è¿›å¢å¼º**: åŸºç¡€åŠŸèƒ½ä¼˜å…ˆï¼Œé«˜çº§ç‰¹æ•ˆå¯é€‰
- **å“åº”å¼è®¾è®¡**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸çš„è®¾å¤‡

---

**å®æ–½è®¡åˆ’**:
1. è®¾è®¡æ ·å¼é…ç½®æ•°æ®ç»“æ„ (20åˆ†é’Ÿ)
2. å®ç°æ ·å¼ç®¡ç†å’Œåº”ç”¨é€»è¾‘ (40åˆ†é’Ÿ)
3. å¼€å‘ç”¨æˆ·ç•Œé¢å’Œäº¤äº’ (30åˆ†é’Ÿ)
4. å®ç°å®æ—¶é¢„è§ˆåŠŸèƒ½ (30åˆ†é’Ÿ)
5. æµ‹è¯•å’Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒ (20åˆ†é’Ÿ)